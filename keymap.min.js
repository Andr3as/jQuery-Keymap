var scripts=document.getElementsByTagName("script"),path=scripts[scripts.length-1].src.split("?")[0],curpath=path.split("/").slice(0,-1).join("/")+"/";!function(e){keyMap={css:{key:{}},selector:""};e.fn.keymap=function(e){e=e||{};if(e.type=="reset"){this.styleKeymap(e.css)}else{this.createKeymap(e)}return this};e.fn.styleKeymap=function(t){if(typeof t!="undefined"){if(typeof t.key!="undefined"){if(typeof t.key.color!="undefined"){e(this.selector+" .keymap-key").css("color",t.key.color)}else{e(this.selector+" .keymap-key").css("color","")}if(typeof t.key.background!="undefined"){e(this.selector+" .keymap-key").css("background-color",t.key.background)}else{e(this.selector+" .keymap-key").css("background-color","")}if(typeof t.key.class!="undefined"){e(this.selector+" .keymap-key").addClass(t.key.class)}}}return this};e.fn.deleteKeymap=function(){this.html("");return this};e.fn.createKeymap=function(t){var s=this;t=t||{};t.layout=t.layout||"qwerty";e.getJSON(curpath+"layouts/"+t.layout+".json",function(a){e(s).html("");var i=s.width()/a.line;var c=a.keys;var n,o,r,l,d,p,f;var y=document.createElement("div");e(y).addClass("line");for(var h=0;h<c.length;h++){n=c[h];d=document.createElement("span");if(typeof n.width=="undefined"){e(d).css("width",i-2+"px")}else{e(d).css("width",i*n.width-2+"px")}if(typeof n.height=="undefined"){e(d).css("height",i-2+"px")}else{e(d).css("height",i*n.height+"px")}if(typeof n.offset=="undefined"){e(d).css("margin-left",1+"px")}else{e(d).css("margin-left",i*n.offset+"px")}if(typeof n.value=="undefined"){e(d).attr("data-value",n.name)}else{e(d).attr("data-value",n.value)}if(e(d).height()>i){e(d).attr("data-height",e(d).height());e(d).attr("data-key",n.code);e(d).height(i-2);e(d).addClass("keymap-key")}else if(n.type=="space"){}else if(n.type=="break"){d=document.createElement("span");s.append(y);y=document.createElement("div");e(y).addClass("line")}else{e(d).addClass("keymap-key");e(d).attr("data-key",n.code)}if(typeof n.name!="undefined"){p=document.createElement("p");e(p).text(n.name);d.appendChild(p)}if(typeof n["z-index"]!="undefined"){e(d).attr("data-index",n["z-index"])}y.appendChild(d)}s.append(y);s.styleKeymap(t.css);e(s.selector+" span").css("display","block");e(s.selector+" .line").css("display","flex");e(s.selector+" p").attr("align","center");e(s.selector+" span").css("margin-right","1px");e(s.selector+" span").css("margin-bottom","1px");e(s.selector+" span").css("margin-top","1px");var u=s.width()/1440*100;s.css("font-size",u+"%");e(s.selector+" span[data-height]").each(function(){e(this).css("position","absolute");e(this).css("z-index",2);e(this).height(e(this).attr("data-height")-2)});e(s.selector+" span[data-index]").each(function(){e(this).css("position","absolute");e(this).css("z-index",3)});keyMap.selector=this.selector;keyMap.css=t.css}).fail(function(t){e(s).html('<p class="keymap-error">Failed to load layout! Check <a href="https://github.com/Andr3as/jQuery-Keymap/wiki/Troubleshooting">error #1</a> for more details.</p>')});return this};e.fn.getKeymap=function(){return keyMap.selector};e.fn.createShortcut=function(t,s,a,i){var c=this;var n;if(typeof s=="undefined"){return false}t=t||keyMap.selector;a=a||{};if(typeof a.class=="undefined"){n=false;a.background=a.background||"red";a.color=a.color||"black"}else{n=true}i=i||"";var o=function(t){if(n){e(t).addClass(a.class)}else{e(t).css("background-color",a.background);e(t).css("color",a.color)}};var r=function(){if(typeof keyMap.css=="undefined"){if(n){e(t+" .keymap-key").removeClass(a.class)}e(t+" .keymap-key").css("color","");e(t+" .keymap-key").css("background-color","")}else{e(t).styleKeymap(keyMap.css)}};var l=function(){r();if(e.isArray(s)){for(var a=0;a<s.length;a++){if(e.isNumeric(s[a])){o(t+" [data-key="+s[a]+"]"+i)}else{o(t+" [data-value="+s[a]+"]"+i)}}}else if(e.isNumeric(s)){o(t+" [data-key="+s+"]"+i)}else{o(t+" [data-value="+s+"]"+i)}};this.click(function(){if(e(".keymap-clicked").length===0){l();c.addClass("keymap-clicked")}else{r();e(".keymap-clicked").removeClass("keymap-clicked")}});this.hover(l,function(){if(e(".keymap-clicked").length===0){r()}});return this}}(jQuery);